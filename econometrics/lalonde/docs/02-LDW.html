<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Tutorial for ‘LaLonde (1986) after Nearly Four Decades: Lessons Learned’ - 2&nbsp; LaLonde-Dehejia-Wahba (LDW) Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./03-NSW.html" rel="next">
<link href="./01-Start.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./02-LDW.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">LaLonde-Dehejia-Wahba (LDW) Data</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Tutorial for ‘LaLonde (1986) after Nearly Four Decades: Lessons Learned’</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/xuyiqing/lalonde/tree/main/tutorial/" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=%7Curl%7C">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=%7Curl%7C">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
      </ul>
</div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome!</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-Start.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting Started</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-LDW.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">LaLonde-Dehejia-Wahba (LDW) Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-NSW.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">LaLonde Male Samples</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-LCS.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">LCS Female Samples</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-IRS.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">The Lottery Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#assessing-overlap" id="toc-assessing-overlap" class="nav-link active" data-scroll-target="#assessing-overlap"><span class="header-section-number">2.1</span> Assessing Overlap</a>
  <ul class="collapse">
<li><a href="#ldw-experimental" id="toc-ldw-experimental" class="nav-link" data-scroll-target="#ldw-experimental"><span class="header-section-number">2.1.1</span> LDW-Experimental</a></li>
  <li><a href="#ldw-cps1-and-ldw-psid1" id="toc-ldw-cps1-and-ldw-psid1" class="nav-link" data-scroll-target="#ldw-cps1-and-ldw-psid1"><span class="header-section-number">2.1.2</span> LDW-CPS1 and LDW-PSID1</a></li>
  <li><a href="#overlap-in-original-ldw-samples" id="toc-overlap-in-original-ldw-samples" class="nav-link" data-scroll-target="#overlap-in-original-ldw-samples"><span class="header-section-number">2.1.3</span> Overlap in Original LDW Samples</a></li>
  </ul>
</li>
  <li><a href="#trimming-to-improve-overlap" id="toc-trimming-to-improve-overlap" class="nav-link" data-scroll-target="#trimming-to-improve-overlap"><span class="header-section-number">2.2</span> Trimming to Improve Overlap</a></li>
  <li><a href="#reassessing-overlap" id="toc-reassessing-overlap" class="nav-link" data-scroll-target="#reassessing-overlap"><span class="header-section-number">2.3</span> Reassessing Overlap</a></li>
  <li><a href="#checking-covariate-balance" id="toc-checking-covariate-balance" class="nav-link" data-scroll-target="#checking-covariate-balance"><span class="header-section-number">2.4</span> Checking Covariate Balance</a></li>
  <li><a href="#estimating-the-att" id="toc-estimating-the-att" class="nav-link" data-scroll-target="#estimating-the-att"><span class="header-section-number">2.5</span> Estimating the ATT</a></li>
  <li>
<a href="#alternative-estimands-catt-and-qtet" id="toc-alternative-estimands-catt-and-qtet" class="nav-link" data-scroll-target="#alternative-estimands-catt-and-qtet"><span class="header-section-number">2.6</span> Alternative Estimands: CATT and QTET</a>
  <ul class="collapse">
<li><a href="#conditional-average-treatment-effect-on-the-treated-catt" id="toc-conditional-average-treatment-effect-on-the-treated-catt" class="nav-link" data-scroll-target="#conditional-average-treatment-effect-on-the-treated-catt"><span class="header-section-number">2.6.1</span> Conditional Average Treatment Effect on the Treated (CATT)</a></li>
  <li><a href="#quantile-treatment-effect-on-the-treated-qtet" id="toc-quantile-treatment-effect-on-the-treated-qtet" class="nav-link" data-scroll-target="#quantile-treatment-effect-on-the-treated-qtet"><span class="header-section-number">2.6.2</span> Quantile Treatment Effect on the Treated (QTET)</a></li>
  </ul>
</li>
  <li><a href="#validation-through-placebo-analyses" id="toc-validation-through-placebo-analyses" class="nav-link" data-scroll-target="#validation-through-placebo-analyses"><span class="header-section-number">2.7</span> Validation through Placebo Analyses</a></li>
  <li><a href="#sensitivity-analyses" id="toc-sensitivity-analyses" class="nav-link" data-scroll-target="#sensitivity-analyses"><span class="header-section-number">2.8</span> Sensitivity Analyses</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">2.9</span> Summary</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/xuyiqing/lalonde/blob/main/tutorial/02-LDW.Rmd" class="toc-action">View source</a></p><p><a href="https://github.com/xuyiqing/lalonde/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">
<span class="chapter-number">2</span>&nbsp; <span class="chapter-title">LaLonde-Dehejia-Wahba (LDW) Data</span>
</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button" data-quarto-source-url="https://github.com/xuyiqing/lalonde/blob/main/tutorial/02-LDW.Rmd">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>LaLonde (1986) assessed the impact of the National Supported Work Demonstration (NSW) program on both female and male participants, with females drawn from the Aid to Families with Dependent Children (AFDC) program and males from three other target groups: ex-drug addicts, ex-criminal offenders, and high-school dropouts. LaLonde used two primary data sources:</p>
<ul>
<li>CPS-SSA-1, from Westat’s Matched Current Population Survey–Social Security Administration File for individuals under 55 matching specific criteria.</li>
<li>PSID-1, from the Panel Study of Income Dynamics for household heads under 55 from specific years who were not retired in 1975, adjusted for factors like employment status and poverty level, resulting in four additional comparison groups.</li>
</ul>
<p>Dehejia and Wahba (1999) subsampled 62% of LaLonde’s original dataset focusing on 1974 earnings and unemployment status of male participants. Since the construction relies solely on pretreatment information like month of assignment and employment history to ensure treatment assignment remains orthogonal to all pretreatment variables, Dehejia and Wahba argue the refined dataset, LaLonde-Dehejia-Wahba (LDW) data, is a valid experimental sample.</p>
<p>Built upon LDW data, our analysis examines three samples: (1) LDW-Experimental, with 185 treated and 280 control participants from the experimental data; (2) LDW-CPS1, featuring the same treated individuals alongside 15,992 controls from CPS-SSA-1; and (3) LDW-PSID1, including the same treated participants and 2,490 controls from PSID-1. Then, we apply the same set of statistical tools to analyze the original male sample from LaLonde (1986) in section 4 as an additional demonstration.</p>
<div class="cell" data-hash="02-LDW_cache/html/unnamed-chunk-1_eff2122396c67fa1e1782024751d04da">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># source the functions provided in part 1</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"https://github.com/xuyiqing/lalonde/blob/main/tutorial/functions.R?raw=TRUE"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="02-LDW_cache/html/unnamed-chunk-2_5418ddfe4512d3ba5057d3d32d4dadfe">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"data/lalonde.RData"</span><span class="op">)</span></span>
<span><span class="va">ldw_co</span><span class="op">$</span><span class="va">treat</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">ldw_cps.plus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind.data.frame</a></span><span class="op">(</span><span class="va">ldw_cps</span>, <span class="va">ldw_co</span><span class="op">)</span></span>
<span><span class="va">ldw_psid.plus</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind.data.frame</a></span><span class="op">(</span><span class="va">ldw_psid</span>, <span class="va">ldw_co</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define variables</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="st">"re78"</span></span>
<span><span class="va">treat</span> <span class="op">&lt;-</span> <span class="st">"treat"</span></span>
<span><span class="va">covar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"education"</span>, <span class="st">"black"</span>, <span class="st">"hispanic"</span>, <span class="st">"married"</span>,</span>
<span>           <span class="st">"nodegree"</span>, <span class="st">"re74"</span>, <span class="st">"re75"</span>, <span class="st">"u74"</span>, <span class="st">"u75"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="assessing-overlap" class="level2" data-number="2.1"><h2 data-number="2.1" class="anchored" data-anchor-id="assessing-overlap">
<span class="header-section-number">2.1</span> Assessing Overlap</h2>
<p>To identify the average causal effect under unconfoundedness, we need to ensure that we can estimate the average effect at every value for the covariates. Thus, we require overlaps between the treated and control units. Using the <code>assess_overlap()</code> function, we can assess overlaps in propensity scores. To test the overlap assumption, we plot histograms using the log-odds of propensity scores, i.e., <span class="math inline">\(\log(\frac{\hat{e}}{1-\hat{e}})\)</span>.</p>
<p>Ideally, for a well-balanced experimental design, the distributions of the treated (red) and the control (gray) groups should overlap.</p>
<section id="ldw-experimental" class="level3" data-number="2.1.1"><h3 data-number="2.1.1" class="anchored" data-anchor-id="ldw-experimental">
<span class="header-section-number">2.1.1</span> LDW-Experimental</h3>
<div class="cell" data-layout-align="center" data-fig.asp="1" data-hash="02-LDW_cache/html/unnamed-chunk-3_7c7387f55c8efbc3feeff4b5e7bf314c">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ldw_ps</span> <span class="op">&lt;-</span> <span class="fu">assess_overlap</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ldw</span>, treat <span class="op">=</span> <span class="va">treat</span>, cov <span class="op">=</span> <span class="va">covar</span><span class="op">)</span></span>
<span><span class="co">#&gt; -1.2254 0.7533904</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02-LDW_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">FIGURE1. SubfigureA:LDW-Experimental.</figcaption></figure>
</div>
</div>
</div>
</section><section id="ldw-cps1-and-ldw-psid1" class="level3" data-number="2.1.2"><h3 data-number="2.1.2" class="anchored" data-anchor-id="ldw-cps1-and-ldw-psid1">
<span class="header-section-number">2.1.2</span> LDW-CPS1 and LDW-PSID1</h3>
<div class="cell" data-fig.asp="0.5" data-hash="02-LDW_cache/html/unnamed-chunk-4_aa5ef5ec213a4f72710ad833768173d1">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ldw_cps_ps</span> <span class="op">&lt;-</span> <span class="fu">assess_overlap</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ldw_cps</span>, treat <span class="op">=</span> <span class="va">treat</span>, cov <span class="op">=</span> <span class="va">covar</span><span class="op">)</span></span>
<span><span class="co">#&gt; -16.1181 1.787226</span></span>
<span><span class="va">ldw_psid_ps</span> <span class="op">&lt;-</span> <span class="fu">assess_overlap</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ldw_psid</span>, treat <span class="op">=</span> <span class="va">treat</span>, cov <span class="op">=</span> <span class="va">covar</span><span class="op">)</span></span>
<span><span class="co">#&gt; -16.1181 3.824234</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02-LDW_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">FIGURE1. SubfigureB:LDW-CPS1. SubfigureC:LDW-PSID1.</figcaption></figure>
</div>
</div>
</div>
</section><section id="overlap-in-original-ldw-samples" class="level3" data-number="2.1.3"><h3 data-number="2.1.3" class="anchored" data-anchor-id="overlap-in-original-ldw-samples">
<span class="header-section-number">2.1.3</span> Overlap in Original LDW Samples</h3>
<p>As expected, LDW-Experimental shows a almost perfect overlap. However, both observational samples show very poor overlaps. Most notably, the propensity scores of many treated units do not lie within the support of the controls’ propensity scores, and a substantial proportion of the control units possess extremely low log-odds.</p>
</section></section><section id="trimming-to-improve-overlap" class="level2" data-number="2.2"><h2 data-number="2.2" class="anchored" data-anchor-id="trimming-to-improve-overlap">
<span class="header-section-number">2.2</span> Trimming to Improve Overlap</h2>
<p>Based on LDW-CPS1 and LDW-PSID1, we further construct two trimmed samples to improve overlap. Trimming involves two steps.</p>
<p>First, we merge the experimental controls from LDW-Experimental into LDW-CPS1 (or LDW-PSID1) to enhance the control group with more units. Then, we can estimate each unit’s propensity included in the experiment using GRF. The purpose of trimming is to remove units that are too dissimilar from the other group to ensure a better balance between the treated and control groups. We can use <code>trim()</code> to trim the data.</p>
<ul>
<li>For LDW-CPS1, the threshold is set at 0.9, meaning any unit with a propensity score higher than 0.9 will be excluded.</li>
<li>For LDW-PSID1, the threshold is lower, at 0.8, indicating a stricter criterion for inclusion in the analysis.</li>
</ul>
<div class="cell" data-hash="02-LDW_cache/html/unnamed-chunk-5_d3609817f62a5822bcdf91fa2a53940b">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># re-estimate each unit’s propensity by merged data</span></span>
<span><span class="va">ldw_cps_ps</span> <span class="op">&lt;-</span> <span class="fu">assess_overlap</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ldw_cps.plus</span>, treat <span class="op">=</span> <span class="va">treat</span>, cov <span class="op">=</span> <span class="va">covar</span><span class="op">)</span></span>
<span><span class="co">#&gt; -16.1181 3.542706</span></span>
<span><span class="va">ldw_psid_ps</span> <span class="op">&lt;-</span> <span class="fu">assess_overlap</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ldw_psid.plus</span>, treat <span class="op">=</span> <span class="va">treat</span>, cov <span class="op">=</span> <span class="va">covar</span><span class="op">)</span></span>
<span><span class="co">#&gt; -16.1181 7.102692</span></span>
<span></span>
<span><span class="va">trim</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">ps</span> <span class="op">=</span> <span class="st">"ps_assoverlap"</span>, <span class="va">threshold</span> <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">sub</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>, <span class="va">ps</span><span class="op">]</span> <span class="op">&lt;</span> <span class="va">threshold</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">sub</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">ldw_cps_trim</span> <span class="op">&lt;-</span> <span class="fu">trim</span><span class="op">(</span><span class="va">ldw_cps_ps</span>, threshold <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span>
<span><span class="va">ldw_psid_trim</span> <span class="op">&lt;-</span> <span class="fu">trim</span><span class="op">(</span><span class="va">ldw_psid_ps</span>, threshold <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Second, using the trimmed data and the same set of covariates, we reestimate propensity scores with GRF; this time, experimental controls are excluded.</p>
<div class="cell" data-hash="02-LDW_cache/html/unnamed-chunk-6_3303a1593874c2f961b7bfe20810719d">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># cps data</span></span>
<span><span class="co"># excluding the experimental controls</span></span>
<span><span class="va">ldw_cps_trim_match</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">ldw_cps_trim</span>, <span class="va">sample</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">ps_assoverlap</span><span class="op">)</span></span>
<span><span class="co"># re-estimate propensity scores and employ 1:1 matching</span></span>
<span><span class="va">ldw_cps_trim_match</span> <span class="op">&lt;-</span> <span class="fu">psmatch</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ldw_cps_trim_match</span>, Y <span class="op">=</span> <span class="st">"re78"</span>, treat <span class="op">=</span> <span class="st">"treat"</span>, cov <span class="op">=</span> <span class="va">covar</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># psid data</span></span>
<span><span class="co"># excluding the experimental controls</span></span>
<span><span class="va">ldw_psid_trim_match</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">ldw_psid_trim</span>, <span class="va">sample</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">ps_assoverlap</span><span class="op">)</span></span>
<span><span class="co"># re-estimate propensity scores and employ 1:1 matching</span></span>
<span><span class="va">ldw_psid_trim_match</span> <span class="op">&lt;-</span> <span class="fu">psmatch</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ldw_psid_trim_match</span>, Y <span class="op">=</span> <span class="st">"re78"</span>, treat <span class="op">=</span> <span class="st">"treat"</span>, cov <span class="op">=</span> <span class="va">covar</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We then employ a 1:1 matching based on the reestimated propensity scores to further trim the nonexperimental controls.</p>
<div class="cell" data-hash="02-LDW_cache/html/unnamed-chunk-7_a223ebbb4758a0bc94c39092b580f341">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># We conduct this procedure to trim all samples simultaneously to improve overlap in the final samples.</span></span>
<span></span>
<span><span class="co">#cps</span></span>
<span><span class="va">ldw_trim_cps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">ldw_cps_trim</span>, <span class="va">sample</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">ps_assoverlap</span> <span class="op">&lt;=</span> <span class="fl">0.9</span><span class="op">)</span></span>
<span><span class="va">ldw_trim_cps</span><span class="op">$</span><span class="va">treat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">ldw_trim_cps</span><span class="op">$</span><span class="va">sample</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="co">#psid</span></span>
<span><span class="va">ldw_trim_psid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">ldw_psid_trim</span>, <span class="va">sample</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">ps_assoverlap</span> <span class="op">&lt;=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="va">ldw_trim_psid</span><span class="op">$</span><span class="va">treat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">ldw_trim_psid</span><span class="op">$</span><span class="va">sample</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="reassessing-overlap" class="level2" data-number="2.3"><h2 data-number="2.3" class="anchored" data-anchor-id="reassessing-overlap">
<span class="header-section-number">2.3</span> Reassessing Overlap</h2>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>As shown in the following figures, overlap improves significantly in both samples post-trimming, though this comes with the cost of reduced sample sizes.</p>
</div>
</div>
<div class="cell" data-fig.asp="0.5" data-hash="02-LDW_cache/html/unnamed-chunk-8_59cf8ff12e978c314d807f24ad561432">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># cps data</span></span>
<span><span class="va">ldw_cps_trim_match_ps</span> <span class="op">&lt;-</span> <span class="fu">assess_overlap</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ldw_cps_trim_match</span>, treat <span class="op">=</span> <span class="va">treat</span>, cov <span class="op">=</span> <span class="va">covar</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># psid data</span></span>
<span><span class="va">ldw_psid_trim_match_ps</span> <span class="op">&lt;-</span> <span class="fu">assess_overlap</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ldw_psid_trim_match</span>, treat <span class="op">=</span> <span class="va">treat</span>, cov <span class="op">=</span> <span class="va">covar</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02-LDW_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">FIGURE1. SubfigureD:TrimmedLDW-CPS1. SubfigureE:TrimmedLDW-PSID1.</figcaption></figure>
</div>
</div>
</div>
</section><section id="checking-covariate-balance" class="level2" data-number="2.4"><h2 data-number="2.4" class="anchored" data-anchor-id="checking-covariate-balance">
<span class="header-section-number">2.4</span> Checking Covariate Balance</h2>
<p>We can also check covariate balance directly by <code>love.plot()</code>. As shown in the following figures, covariate overlap improves significantly in both samples post-trimming (matching).</p>
<div>
<details open=""><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># cps data</span></span>
<span><span class="fu">love.plot</span><span class="op">(</span><span class="va">ldw_cps</span>, <span class="va">ldw_cps_trim_match</span>, treat <span class="op">=</span> <span class="va">treat</span>, covar <span class="op">=</span> <span class="va">covar</span>, title <span class="op">=</span> <span class="st">"Covariate Balance of LDW-CPS1"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># psid data</span></span>
<span><span class="fu">love.plot</span><span class="op">(</span><span class="va">ldw_psid</span>, <span class="va">ldw_psid_trim_match</span>, treat <span class="op">=</span> <span class="va">treat</span>, covar <span class="op">=</span> <span class="va">covar</span>, title <span class="op">=</span> <span class="st">"Covariate Balance of LDW-PSID1"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell quarto-layout-panel" data-fig.asp="0.8" data-hash="02-LDW_cache/html/unnamed-chunk-9_8aa3317f917024ac324bbcec2522149a">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="02-LDW_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="02-LDW_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid"></p>
</div>
</div>
</div>
</div>
</section><section id="estimating-the-att" class="level2" data-number="2.5"><h2 data-number="2.5" class="anchored" data-anchor-id="estimating-the-att">
<span class="header-section-number">2.5</span> Estimating the ATT</h2>
<p>Next, we estimate the ATT using both the original LDW observational samples and the newly constructed trimmed samples. We apply a variety of estimators, including simple difference-in-means, regression, the OaxacaBlinderestimator, GRF as an outcome model, 1: 5 nearest neighbor matching with bias correction, IPW with propensity scores estimated by GRF, covariate balancing propensity score (CBPS), entropy balancing, double/debiased matching learning using elastic net, and AIPW implemented via GRF. All estimators use the same set of ten covariates as before.</p>
<p>To achieve such a comprehensive analysis of the ATT, we can use the <code>estimate_all()</code> and <code>plot_coef()</code> function.</p>
<div class="cell" data-hash="02-LDW_cache/html/lwd_trim_att_7178aec202afbce1496e6eeda200f692">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"data/trimmed.RData"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># experimental</span></span>
<span><span class="va">out1</span> <span class="op">&lt;-</span> <span class="fu">estimate_all</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ldw</span>, Y <span class="op">=</span> <span class="st">"re78"</span>, treat <span class="op">=</span> <span class="st">"treat"</span>, cov <span class="op">=</span> <span class="va">covar</span><span class="op">)</span></span>
<span><span class="va">out2</span> <span class="op">&lt;-</span> <span class="fu">estimate_all</span><span class="op">(</span><span class="va">ldw_trim_cps</span>, <span class="st">"re78"</span>, <span class="st">"treat"</span>, <span class="va">covar</span><span class="op">)</span></span>
<span><span class="va">out3</span> <span class="op">&lt;-</span> <span class="fu">estimate_all</span><span class="op">(</span><span class="va">ldw_trim_psid</span>, <span class="st">"re78"</span>, <span class="st">"treat"</span>, <span class="va">covar</span><span class="op">)</span></span>
<span><span class="co"># nonexperimental</span></span>
<span><span class="va">out4</span> <span class="op">&lt;-</span> <span class="fu">estimate_all</span><span class="op">(</span><span class="va">ldw_cps</span>, <span class="st">"re78"</span>, <span class="st">"treat"</span>, <span class="va">covar</span><span class="op">)</span></span>
<span><span class="va">out5</span> <span class="op">&lt;-</span> <span class="fu">estimate_all</span><span class="op">(</span><span class="va">ldw_psid</span>, <span class="st">"re78"</span>, <span class="st">"treat"</span>, <span class="va">covar</span><span class="op">)</span></span>
<span><span class="va">out6</span> <span class="op">&lt;-</span> <span class="fu">estimate_all</span><span class="op">(</span><span class="va">ldw_cps_trim</span>, <span class="st">"re78"</span>, <span class="st">"treat"</span>, <span class="va">covar</span><span class="op">)</span></span>
<span><span class="va">out7</span> <span class="op">&lt;-</span> <span class="fu">estimate_all</span><span class="op">(</span><span class="va">ldw_psid_trim</span>, <span class="st">"re78"</span>, <span class="st">"treat"</span>, <span class="va">covar</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-fig.asp="1" data-hash="02-LDW_cache/html/unnamed-chunk-10_b296766d199fe3245ef611ffcdd886e2">
<details><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">band</span> <span class="op">&lt;-</span> <span class="va">out1</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="va">est</span> <span class="op">&lt;-</span> <span class="va">out1</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu">plot_coef</span><span class="op">(</span><span class="va">out4</span>, band <span class="op">=</span> <span class="va">band</span>, line <span class="op">=</span> <span class="va">est</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">15500</span>, <span class="fl">5500</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"(A) LDW-CPS1"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">band</span> <span class="op">&lt;-</span> <span class="va">out1</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="va">est</span> <span class="op">&lt;-</span> <span class="va">out1</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu">plot_coef</span><span class="op">(</span><span class="va">out5</span>, band <span class="op">=</span> <span class="va">band</span>, line <span class="op">=</span> <span class="va">est</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">15500</span>, <span class="fl">5500</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"(B) LDW-PSID1"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">band</span> <span class="op">&lt;-</span> <span class="va">out2</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="va">est</span> <span class="op">&lt;-</span> <span class="va">out2</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu">plot_coef</span><span class="op">(</span><span class="va">out6</span>, band <span class="op">=</span> <span class="va">band</span>, line <span class="op">=</span> <span class="va">est</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">15500</span>, <span class="fl">5500</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"(C) Trimmed LDW-CPS1"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">band</span> <span class="op">&lt;-</span> <span class="va">out3</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="va">est</span> <span class="op">&lt;-</span> <span class="va">out3</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu">plot_coef</span><span class="op">(</span><span class="va">out7</span>, band <span class="op">=</span> <span class="va">band</span>, line <span class="op">=</span> <span class="va">est</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">15500</span>, <span class="fl">5500</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"(D) Trimmed LDW-PSID1"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02-LDW_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">FIGURE 3. ATT Estimates Given Unconfoundedness: LDW Samples</figcaption></figure>
</div>
</div>
</div>
<p>The above figures show the ATT estimates and their 95% confidence intervals using four different samples: LDW-CPS1, LDW-PSID1, Trimmed LDW-CPS1, and Trimmed LDW-PSID1.</p>
<p>As shown in Figure 3(A), when using LDW-CPS1, all estimators, except difference in-means, produce positive estimates, although there are noticeable variations among them. Nearest neighbor matching outperforms other estimators, aligning closely with the experimental benchmark of $1,794. Notably, CBPS, entropy balancing, and AIPW-GRF also produce results close to the benchmark. Despite numerical differences, these estimates, except for difference-in-means, cannot be statistically distinguished from one another. Figure 3(B) shows that estimates based on LDW-PSID1 exhibit greater variations. Setting aside the difference-in-means, the estimates span from $4 to $2,420. Among them, the AIPW-GRF estimator produces an estimate closest to the experimental benchmark.</p>
<p>Figure 3(C) and (D) show that by using trimmed data with improved overlap, estimates produced by various estimators are substantially more stable.</p>
<p>The ATT results are presented in the table below:</p>
<div class="cell" data-hash="02-LDW_cache/html/unnamed-chunk-11_b73961d741dfa17a7f8574d6197ab236">
<details><summary>Code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># print the result</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">out4</span>, <span class="va">out5</span>, <span class="va">out6</span>, <span class="va">out7</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">out1</span><span class="op">)</span></span>
<span><span class="va">sav</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="st">""</span>, <span class="va">n</span><span class="op">+</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">*</span><span class="fl">3</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">out</span> <span class="op">&lt;-</span> <span class="va">a</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">sav</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span><span class="op">*</span><span class="fl">3</span><span class="op">-</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">out</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="va">sav</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span><span class="op">*</span><span class="fl">3</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">out</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="st">")"</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="va">sav</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">out1</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">sav</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">out1</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="st">")"</span><span class="op">)</span></span>
<span><span class="va">sav</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">out1</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">sav</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">out1</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="st">")"</span><span class="op">)</span></span>
<span><span class="va">sav</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">7</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">out2</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">sav</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">8</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">out2</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="st">")"</span><span class="op">)</span></span>
<span><span class="va">sav</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">out3</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">sav</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">11</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">out3</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="st">")"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">sav</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LDW-CPS1"</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">"LDW-PSID1"</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">"LDW-CPS1 (PS Trimmed) "</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">"LDW-PSID1 (PS Trimmed)"</span>, <span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">sav</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Experimental Benchmark"</span>, <span class="st">"Difference-in-Means"</span>, <span class="st">"Regression"</span>, <span class="st">" Oaxaca Blinder"</span>, <span class="st">"GRF"</span>, <span class="st">"NN Matching"</span>, <span class="st">"PS Matching"</span>, <span class="st">"IPW"</span>, <span class="st">"CBPS"</span>, <span class="st">"Entropy Balancing"</span>, <span class="st">"DML-ElasticNet"</span>, <span class="st">"AIPW-GRF"</span><span class="op">)</span></span>
<span><span class="va">sav</span> <span class="op">%&gt;%</span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>booktabs<span class="op">=</span><span class="cn">TRUE</span>, caption <span class="op">=</span> <span class="st">" Table B1 in the Supplementary Materials (SM)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table B1 in the Supplementary Materials (SM)</caption>
<colgroup>
<col style="width: 17%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 2%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 2%">
<col style="width: 17%">
<col style="width: 6%">
<col style="width: 2%">
<col style="width: 17%">
<col style="width: 7%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">LDW-CPS1</th>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
<th style="text-align: left;">LDW-PSID1</th>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
<th style="text-align: left;">LDW-CPS1 (PS Trimmed)</th>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
<th style="text-align: left;">LDW-PSID1 (PS Trimmed)</th>
<th style="text-align: left;"></th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Experimental Benchmark</td>
<td style="text-align: left;">1794.34</td>
<td style="text-align: left;">(670.82)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">1794.34</td>
<td style="text-align: left;">(670.82)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">1911.04</td>
<td style="text-align: left;">(737.71)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">306.29</td>
<td style="text-align: left;">(985.98)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Difference-in-Means</td>
<td style="text-align: left;">-8497.52</td>
<td style="text-align: left;">(581.92)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-15204.78</td>
<td style="text-align: left;">(655.91)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">1483.82</td>
<td style="text-align: left;">(824.44)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-1505.24</td>
<td style="text-align: left;">(1219.89)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Regression</td>
<td style="text-align: left;">1066.38</td>
<td style="text-align: left;">(626.85)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">4.16</td>
<td style="text-align: left;">(854.15)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">1751.16</td>
<td style="text-align: left;">(824.20)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-1939.59</td>
<td style="text-align: left;">(1154.45)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Oaxaca Blinder</td>
<td style="text-align: left;">1133.28</td>
<td style="text-align: left;">(624.26)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">687.82</td>
<td style="text-align: left;">(635.26)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">1507.48</td>
<td style="text-align: left;">(672.08)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-1511.20</td>
<td style="text-align: left;">(900.46)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GRF</td>
<td style="text-align: left;">1078.83</td>
<td style="text-align: left;">(629.88)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">766.29</td>
<td style="text-align: left;">(635.04)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">1442.19</td>
<td style="text-align: left;">(665.76)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-1401.32</td>
<td style="text-align: left;">(792.83)</td>
</tr>
<tr class="even">
<td style="text-align: left;">NN Matching</td>
<td style="text-align: left;">1729.12</td>
<td style="text-align: left;">(815.38)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">2255.47</td>
<td style="text-align: left;">(1403.83)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">2137.90</td>
<td style="text-align: left;">(946.11)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-1564.93</td>
<td style="text-align: left;">(1209.89)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PS Matching</td>
<td style="text-align: left;">1360.89</td>
<td style="text-align: left;">(748.71)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">2275.83</td>
<td style="text-align: left;">(762.42)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">1341.73</td>
<td style="text-align: left;">(802.29)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-2746.63</td>
<td style="text-align: left;">(1275.32)</td>
</tr>
<tr class="even">
<td style="text-align: left;">IPW</td>
<td style="text-align: left;">1236.84</td>
<td style="text-align: left;">(687.14)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">739.34</td>
<td style="text-align: left;">(893.32)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">1343.01</td>
<td style="text-align: left;">(826.44)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-2117.63</td>
<td style="text-align: left;">(1270.02)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CBPS</td>
<td style="text-align: left;">1408.01</td>
<td style="text-align: left;">(654.96)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">2437.70</td>
<td style="text-align: left;">(877.80)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">1471.35</td>
<td style="text-align: left;">(813.29)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-1885.28</td>
<td style="text-align: left;">(1369.64)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Entropy Balancing</td>
<td style="text-align: left;">1406.27</td>
<td style="text-align: left;">(654.93)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">2420.49</td>
<td style="text-align: left;">(876.85)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">1472.12</td>
<td style="text-align: left;">(812.92)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-1776.73</td>
<td style="text-align: left;">(1551.89)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DML-ElasticNet</td>
<td style="text-align: left;">1068.62</td>
<td style="text-align: left;">(627.81)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">91.01</td>
<td style="text-align: left;">(861.30)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">1912.25</td>
<td style="text-align: left;">(818.40)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-2112.57</td>
<td style="text-align: left;">(1125.17)</td>
</tr>
<tr class="even">
<td style="text-align: left;">AIPW-GRF</td>
<td style="text-align: left;">1571.17</td>
<td style="text-align: left;">(703.86)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">1422.82</td>
<td style="text-align: left;">(772.78)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">1426.58</td>
<td style="text-align: left;">(815.99)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-1830.25</td>
<td style="text-align: left;">(1169.91)</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Columns 1 and 2 report the estimates from LDW-CPS1 and LDW-PSID1, respectively, while columns 3 and 4 report the estimates from the trimmed samples with improved overlap. Robust standard errors are in the parentheses. Improved overlap in trimmed samples generally leads to estimates with higher consistency with the benchmark. The trimmed samples often show increased standard errors, which is expected as trimming reduces the sample size, thus increasing variance.</p>
<p>As shown in column 1, when using LDW-CPS1, all estimators, except difference-in-means, produce estimates exceeding $1,000, although there are noticeable variations among them. Nearest neighbor matching outperforms other estimators, aligning closely with the experimental benchmark of $1,794. Notably, propensity score matching, entropy balancing, and AIPW-GRF also produce results close to the benchmark. The standard errors of these estimates are large. As a result, despite numerical differences, these estimates, except for difference-in-means, cannot be statistically distinguished from one another. Column 2 shows that estimates based on LDW-PSID1 exhibit greater variations.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>These findings suggest that while improved overlap based on observed covariates can reduce model dependency and estimate variability across different estimators, it does not guarantee consistency without validating unconfoundedness.</p>
</div>
</div>
</section><section id="alternative-estimands-catt-and-qtet" class="level2" data-number="2.6"><h2 data-number="2.6" class="anchored" data-anchor-id="alternative-estimands-catt-and-qtet">
<span class="header-section-number">2.6</span> Alternative Estimands: CATT and QTET</h2>
<section id="conditional-average-treatment-effect-on-the-treated-catt" class="level3" data-number="2.6.1"><h3 data-number="2.6.1" class="anchored" data-anchor-id="conditional-average-treatment-effect-on-the-treated-catt">
<span class="header-section-number">2.6.1</span> Conditional Average Treatment Effect on the Treated (CATT)</h3>
<p>Exploring causal estimates for alternative estimands, such as heterogeneous treatment effects and quantile treatment effects, can help assess unconfoundedness.</p>
<p>CATT can reveal how the treatment effect varies across different subgroups defined by covariates. Using both the original LDW data and the trimmed versions, we estimate the CATT using a causal forest through AIPW-GRF. We can use the wrapper function <code>catt()</code> to estimate CATT.</p>
<div class="cell" data-hash="02-LDW_cache/html/unnamed-chunk-12_6217880e886137e4098d3ac518efb559">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># estimate catt</span></span>
<span><span class="va">catt.ldw</span> <span class="op">&lt;-</span> <span class="fu">catt</span><span class="op">(</span><span class="va">ldw</span>, <span class="va">Y</span>, <span class="va">treat</span>, <span class="va">covar</span><span class="op">)</span></span>
<span><span class="va">catt.cps</span> <span class="op">&lt;-</span> <span class="fu">catt</span><span class="op">(</span><span class="va">ldw_cps</span>, <span class="va">Y</span>, <span class="va">treat</span>, <span class="va">covar</span><span class="op">)</span></span>
<span><span class="va">catt.psid</span> <span class="op">&lt;-</span> <span class="fu">catt</span><span class="op">(</span><span class="va">ldw_psid</span>, <span class="va">Y</span>, <span class="va">treat</span>, <span class="va">covar</span><span class="op">)</span></span>
<span><span class="va">catt.cps.trim</span> <span class="op">&lt;-</span> <span class="fu">catt</span><span class="op">(</span><span class="va">ldw_cps_trim</span>, <span class="va">Y</span>, <span class="va">treat</span>, <span class="va">covar</span><span class="op">)</span></span>
<span><span class="va">catt.psid.trim</span> <span class="op">&lt;-</span> <span class="fu">catt</span><span class="op">(</span><span class="va">ldw_psid_trim</span>, <span class="va">Y</span>, <span class="va">treat</span>, <span class="va">covar</span><span class="op">)</span></span>
<span><span class="co"># trimmed experimental data</span></span>
<span><span class="va">catt.ldw.cps</span> <span class="op">&lt;-</span> <span class="fu">catt</span><span class="op">(</span><span class="va">ldw_trim_cps</span>, <span class="va">Y</span>, <span class="va">treat</span>, <span class="va">covar</span><span class="op">)</span></span>
<span><span class="va">catt.ldw.psid</span> <span class="op">&lt;-</span> <span class="fu">catt</span><span class="op">(</span><span class="va">ldw_trim_psid</span>, <span class="va">Y</span>, <span class="va">treat</span>, <span class="va">covar</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Then, we can use <code>plot_catt()</code> to visualize the result. In the following figures, we plot the estimated CATT from observational data at the covariate values of each treated unit against their corresponding experimental benchmarks. The gray dot represents a pair of CATT estimates, while the red cross depicts the pair of estimated ATTs.</p>
<div class="cell" data-fig.asp="1" data-hash="02-LDW_cache/html/unnamed-chunk-13_0133391e21ad21c42fe5ceed081f1f80">
<details><summary>Code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># plot catt - "CATT (Experimental)" and "CATT (CPS-Full)"</span></span>
<span><span class="va">catt1</span> <span class="op">&lt;-</span> <span class="va">catt.ldw</span><span class="op">$</span><span class="va">catt</span></span>
<span><span class="va">att1</span> <span class="op">&lt;-</span> <span class="va">catt.ldw</span><span class="op">$</span><span class="va">att</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">catt2</span> <span class="op">&lt;-</span> <span class="va">catt.cps</span><span class="op">$</span><span class="va">catt</span></span>
<span><span class="va">att2</span> <span class="op">&lt;-</span> <span class="va">catt.cps</span><span class="op">$</span><span class="va">att</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu">plot_catt</span><span class="op">(</span><span class="va">catt1</span>, <span class="va">catt2</span>, <span class="va">att1</span>, <span class="va">att2</span>, <span class="st">"CATT (Experimental)"</span>, <span class="st">"CATT (CPS-Full)"</span>,</span>
<span>          main <span class="op">=</span> <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8000</span>, <span class="fl">8000</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot catt - "CATT (Experimental)" and "CATT (PSID-Full)"</span></span>
<span><span class="va">catt1</span> <span class="op">&lt;-</span> <span class="va">catt.ldw</span><span class="op">$</span><span class="va">catt</span></span>
<span><span class="va">att1</span> <span class="op">&lt;-</span> <span class="va">catt.ldw</span><span class="op">$</span><span class="va">att</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">catt2</span> <span class="op">&lt;-</span> <span class="va">catt.psid</span><span class="op">$</span><span class="va">catt</span></span>
<span><span class="va">att2</span> <span class="op">&lt;-</span> <span class="va">catt.psid</span><span class="op">$</span><span class="va">att</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu">plot_catt</span><span class="op">(</span><span class="va">catt1</span>, <span class="va">catt2</span>, <span class="va">att1</span>, <span class="va">att2</span>, <span class="st">"CATT (Experimental)"</span>, <span class="st">"CATT (PSID-Full)"</span>,</span>
<span>    main <span class="op">=</span> <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8000</span>, <span class="fl">8000</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot catt - "CATT (Experimental)" and "CATT (CPS-Trimmed)"</span></span>
<span><span class="va">catt1</span> <span class="op">&lt;-</span> <span class="va">catt.ldw.cps</span><span class="op">$</span><span class="va">catt</span></span>
<span><span class="va">att1</span> <span class="op">&lt;-</span> <span class="va">catt.ldw.cps</span><span class="op">$</span><span class="va">att</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">catt2</span> <span class="op">&lt;-</span> <span class="va">catt.cps.trim</span><span class="op">$</span><span class="va">catt</span></span>
<span><span class="va">att2</span> <span class="op">&lt;-</span> <span class="va">catt.cps.trim</span><span class="op">$</span><span class="va">att</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu">plot_catt</span><span class="op">(</span><span class="va">catt1</span>, <span class="va">catt2</span>, <span class="va">att1</span>, <span class="va">att2</span>, <span class="st">"CATT (Experimental)"</span>, <span class="st">"CATT (CPS-Trimmed)"</span>,</span>
<span>    main <span class="op">=</span> <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8000</span>, <span class="fl">8000</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot catt - "CATT (Experimental)" and "CATT (PSID-Trimmed)"</span></span>
<span><span class="va">catt1</span> <span class="op">&lt;-</span> <span class="va">catt.ldw.psid</span><span class="op">$</span><span class="va">catt</span></span>
<span><span class="va">att1</span> <span class="op">&lt;-</span> <span class="va">catt.ldw.psid</span><span class="op">$</span><span class="va">att</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">catt2</span> <span class="op">&lt;-</span> <span class="va">catt.psid.trim</span><span class="op">$</span><span class="va">catt</span></span>
<span><span class="va">att2</span> <span class="op">&lt;-</span> <span class="va">catt.psid.trim</span><span class="op">$</span><span class="va">att</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu">plot_catt</span><span class="op">(</span><span class="va">catt1</span>, <span class="va">catt2</span>, <span class="va">att1</span>, <span class="va">att2</span>, <span class="st">"CATT (Experimental)"</span>, <span class="st">"CATT (PSID-Trimmed)"</span>,</span>
<span>    main <span class="op">=</span> <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">8000</span>, <span class="fl">8000</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02-LDW_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">FIGURE 4. CATT Estimates using LDW Data: Experimental vs.&nbsp;Nonexperimental</figcaption></figure>
</div>
</div>
</div>
<p>Although the AIPW estimator can produce ATT estimates closely aligned with the experimental benchmark using LDW data, its performance for revealing the true CATT is considerably worse. Specifically, with LDW-CPS1, CATT estimates span from $-5,456.1 to $6,997.1, contrasting with the CATT estimated from experimental data which ranges from $-345.3 to $4,148.5. It overestimates CATT that exceeds the ATT and underestimates CATT that falls below the ATT. Employing LDW-PSID generates CATT estimates ranging from $-8131.2 to $4381.0. With trimmed LDW-CPS, the CATT estimates align more closely with those from the experimental data. However, using trimmed LDW-PSID, the majority of CATT estimates are negative, suggesting significant biases.</p>
</section><section id="quantile-treatment-effect-on-the-treated-qtet" class="level3" data-number="2.6.2"><h3 data-number="2.6.2" class="anchored" data-anchor-id="quantile-treatment-effect-on-the-treated-qtet">
<span class="header-section-number">2.6.2</span> Quantile Treatment Effect on the Treated (QTET)</h3>
<p>QTET is less sensitive to outliers and can uncover the heterogeneity in treatment effects that may be obscured by average treatment effect estimates. Our calculation of the QTET uses the propensity score re-weighting approach proposed by Firpo (2007).</p>
<p>To proceed, we can use the wrapper function <code>qte()</code>.</p>
<div class="cell" data-hash="02-LDW_cache/html/unnamed-chunk-14_c288bd4486129e9e8fbd71557a8e47c3">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># estimate qte (some of the following lines are not run due to computational limitation)</span></span>
<span></span>
<span><span class="co">## experimental</span></span>
<span><span class="va">qte.ldw</span> <span class="op">&lt;-</span> <span class="fu">est_qte</span><span class="op">(</span><span class="va">Y</span>, <span class="va">treat</span>, <span class="cn">NULL</span>, data <span class="op">=</span> <span class="va">ldw</span><span class="op">)</span></span>
<span><span class="va">qte.ldw.cps</span> <span class="op">&lt;-</span> <span class="fu">est_qte</span><span class="op">(</span><span class="va">Y</span>, <span class="va">treat</span>, <span class="cn">NULL</span>, data <span class="op">=</span> <span class="va">ldw_trim_cps</span><span class="op">)</span></span>
<span><span class="va">qte.ldw.psid</span> <span class="op">&lt;-</span> <span class="fu">est_qte</span><span class="op">(</span><span class="va">Y</span>, <span class="va">treat</span>, <span class="cn">NULL</span>, data <span class="op">=</span> <span class="va">ldw_trim_psid</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## non-experimental</span></span>
<span><span class="co">#qte.ldw_cps &lt;- est_qte(Y, treat, covar, data = ldw_cps) # adjusted</span></span>
<span><span class="co">#qte.ldw_cps0 &lt;- est_qte(Y, treat, NULL, data = ldw_cps) # unadjusted</span></span>
<span><span class="va">qte.ldw_cps.trim</span> <span class="op">&lt;-</span> <span class="fu">est_qte</span><span class="op">(</span><span class="va">Y</span>, <span class="va">treat</span>, <span class="va">covar</span>, data <span class="op">=</span> <span class="va">ldw_cps_trim</span><span class="op">)</span> <span class="co"># adjusted</span></span>
<span><span class="va">qte.ldw_cps.trim0</span> <span class="op">&lt;-</span> <span class="fu">est_qte</span><span class="op">(</span><span class="va">Y</span>, <span class="va">treat</span>, <span class="cn">NULL</span>, data <span class="op">=</span> <span class="va">ldw_cps_trim</span><span class="op">)</span> <span class="co"># unadjusted</span></span>
<span><span class="co">#qte.ldw_psid &lt;- est_qte(Y, treat, covar, data = ldw_psid) # adjusted</span></span>
<span><span class="co">#qte.ldw_psid0 &lt;- est_qte(Y, treat, NULL, data = ldw_psid) # unadjusted</span></span>
<span><span class="va">qte.ldw_psid.trim</span> <span class="op">&lt;-</span> <span class="fu">est_qte</span><span class="op">(</span><span class="va">Y</span>, <span class="va">treat</span>, <span class="va">covar</span>, data <span class="op">=</span> <span class="va">ldw_psid_trim</span><span class="op">)</span> <span class="co"># adjusted</span></span>
<span><span class="va">qte.ldw_psid.trim0</span> <span class="op">&lt;-</span> <span class="fu">est_qte</span><span class="op">(</span><span class="va">Y</span>, <span class="va">treat</span>, <span class="cn">NULL</span>, data <span class="op">=</span> <span class="va">ldw_psid_trim</span><span class="op">)</span> <span class="co"># unadjusted</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We can use <code>plot_qte()</code> to plot the result and compare the treatment effects estimated both before and after trimming based on propensity scores.</p>
<p>For each dataset, there are three lines representing:</p>
<ul>
<li>Experimental (blue line with diamond markers): QTET estimates based on experimental data, which serve as a benchmark.</li>
<li>Unadjusted (pink line with triangle markers): QTET estimates from the observational data without any adjustments.</li>
<li>Adjusted (black line with circle markers): QTET estimates from the observational data after adjusting for covariates.</li>
</ul>
<div class="cell" data-fig.asp="1" data-hash="02-LDW_cache/html/unnamed-chunk-15_24869e4fe90b8a0e3975096b26b89bc2">
<details><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># plot qte</span></span>
<span></span>
<span><span class="co">#load the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"data/qte_ldw.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># CPS</span></span>
<span><span class="fu">plot_qte</span><span class="op">(</span><span class="va">qte.ldw_cps</span>, <span class="va">qte.ldw_cps0</span>, <span class="va">qte.ldw</span>, main <span class="op">=</span> <span class="st">"LDW-CPS"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">25000</span>, <span class="fl">15000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"bottomleft"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Experimental"</span>, <span class="st">"Unadjusted"</span>, <span class="st">"Adjusted"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fl">1</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">16</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## CPS trimmed</span></span>
<span><span class="fu">plot_qte</span><span class="op">(</span><span class="va">qte.ldw_cps.trim</span>, <span class="va">qte.ldw_cps.trim0</span>, <span class="va">qte.ldw.cps</span>, main <span class="op">=</span> <span class="st">"LDW-CPS (Trimmed)"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">25000</span>, <span class="fl">15000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"bottomleft"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Experimental"</span>, <span class="st">"Unadjusted"</span>, <span class="st">"Adjusted"</span><span class="op">)</span>, </span>
<span>    lty <span class="op">=</span> <span class="fl">1</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">16</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># PSID</span></span>
<span><span class="fu">plot_qte</span><span class="op">(</span><span class="va">qte.ldw_psid</span>, <span class="va">qte.ldw_psid0</span>, <span class="va">qte.ldw</span>, main <span class="op">=</span> <span class="st">"LDW-PSID"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">25000</span>, <span class="fl">15000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"bottomleft"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Experimental"</span>, <span class="st">"Unadjusted"</span>, <span class="st">"Adjusted"</span><span class="op">)</span>, </span>
<span>    lty <span class="op">=</span> <span class="fl">1</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">16</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># PSID trimmed</span></span>
<span><span class="fu">plot_qte</span><span class="op">(</span><span class="va">qte.ldw_psid.trim</span>, <span class="va">qte.ldw_psid.trim0</span>, <span class="va">qte.ldw.psid</span>, main <span class="op">=</span> <span class="st">"LDW-PSID (Trimmed)"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">25000</span>, <span class="fl">15000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"bottomleft"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Experimental"</span>, <span class="st">"Unadjusted"</span>, <span class="st">"Adjusted"</span><span class="op">)</span>, </span>
<span>    lty <span class="op">=</span> <span class="fl">1</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">16</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02-LDW_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">FIGURE 5. Quantile Treatment Effects: Experimental vs.&nbsp;Nonexperimental</figcaption></figure>
</div>
</div>
</div>
<p>These figures plot the QTET estimates using both the LDW experimental data and non-experimental data. The QTET estimates from either the original or trimmed LDW-CPS1 data align reasonably well with the true QTET, although they are often underpowered. In contrast, the QTET of the original or trimmed LDW-PSID1 data displays notable biases compared to the experimental benchmark, which is close to zero.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>This analysis suggests that, when considering alternative estimands such as CATT and QTET among the four observational samples, only trimmed LDW-CPS1 yields results consistently aligned closely with the experimental benchmark.</p>
</div>
</div>
</section></section><section id="validation-through-placebo-analyses" class="level2" data-number="2.7"><h2 data-number="2.7" class="anchored" data-anchor-id="validation-through-placebo-analyses">
<span class="header-section-number">2.7</span> Validation through Placebo Analyses</h2>
<p>We conduct placebo analyses to further assess the plausibility of unconfoundedness. To do so, we select earnings in 1975 (re75) as the placebo outcome and remove both re75 and u75 from the set of conditioning variables. The trimmed samples are based on 1:1 matching of propensity scores estimated via GRF. (Two new trimmed samples are created without using re75 and u75.) Similarly, we can use <code>estimate_all</code> to calculate the ATT for the placebo analysis, conditional on the remaining covariates.</p>
<div class="cell" data-hash="02-LDW_cache/html/unnamed-chunk-16_3dca02adba915fb5213f2fe437a01b6e">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="st">"re75"</span></span>
<span><span class="va">treat</span> <span class="op">&lt;-</span> <span class="st">"treat"</span></span>
<span><span class="va">covar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"education"</span>, <span class="st">"black"</span>, <span class="st">"hispanic"</span>, <span class="st">"married"</span>, <span class="st">"nodegree"</span>, <span class="st">"re74"</span>, <span class="st">"u74"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># experimental</span></span>
<span><span class="va">out1</span> <span class="op">&lt;-</span> <span class="fu">estimate_all</span><span class="op">(</span><span class="va">ldw</span>, <span class="va">Y</span>, <span class="st">"treat"</span>, <span class="va">covar</span><span class="op">)</span></span>
<span><span class="va">out2</span> <span class="op">&lt;-</span> <span class="fu">estimate_all</span><span class="op">(</span><span class="va">ldw_trim_cps_pl</span>, <span class="va">Y</span>, <span class="st">"treat"</span>, <span class="va">covar</span><span class="op">)</span></span>
<span><span class="va">out3</span> <span class="op">&lt;-</span> <span class="fu">estimate_all</span><span class="op">(</span><span class="va">ldw_trim_psid_pl</span>, <span class="va">Y</span>, <span class="st">"treat"</span>, <span class="va">covar</span><span class="op">)</span></span>
<span><span class="co"># no experimental</span></span>
<span><span class="va">out4</span> <span class="op">&lt;-</span> <span class="fu">estimate_all</span><span class="op">(</span><span class="va">ldw_cps</span>, <span class="va">Y</span>, <span class="st">"treat"</span>, <span class="va">covar</span><span class="op">)</span></span>
<span><span class="va">out5</span> <span class="op">&lt;-</span> <span class="fu">estimate_all</span><span class="op">(</span><span class="va">ldw_psid</span>, <span class="va">Y</span>, <span class="st">"treat"</span>, <span class="va">covar</span><span class="op">)</span></span>
<span><span class="va">out6</span> <span class="op">&lt;-</span> <span class="fu">estimate_all</span><span class="op">(</span><span class="va">ldw_cps_trim_pl</span>, <span class="va">Y</span>, <span class="st">"treat"</span>, <span class="va">covar</span><span class="op">)</span></span>
<span><span class="va">out7</span> <span class="op">&lt;-</span> <span class="fu">estimate_all</span><span class="op">(</span><span class="va">ldw_psid_trim_pl</span>, <span class="va">Y</span>, <span class="st">"treat"</span>, <span class="va">covar</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-fig.asp="1" data-hash="02-LDW_cache/html/unnamed-chunk-17_57fb5c4fef7cb1f1d971b9a1d3b399c1">
<details><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">band</span> <span class="op">&lt;-</span> <span class="va">out1</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="va">est</span> <span class="op">&lt;-</span> <span class="va">out1</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">ylim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">12000</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="fu">plot_coef</span><span class="op">(</span><span class="va">out4</span>, band <span class="op">=</span> <span class="va">band</span>, line <span class="op">=</span> <span class="va">est</span>, ylim <span class="op">=</span> <span class="va">ylim</span>, main <span class="op">=</span> <span class="st">"(A) LDW-CPS1"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">band</span> <span class="op">&lt;-</span> <span class="va">out1</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="va">est</span> <span class="op">&lt;-</span> <span class="va">out1</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu">plot_coef</span><span class="op">(</span><span class="va">out5</span>, band <span class="op">=</span> <span class="va">band</span>, line <span class="op">=</span> <span class="va">est</span>, ylim <span class="op">=</span> <span class="va">ylim</span>, main <span class="op">=</span> <span class="st">"(B) LDW-PSID1"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">band</span> <span class="op">&lt;-</span> <span class="va">out2</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="va">est</span> <span class="op">&lt;-</span> <span class="va">out2</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu">plot_coef</span><span class="op">(</span><span class="va">out6</span>, band <span class="op">=</span> <span class="va">band</span>, line <span class="op">=</span> <span class="va">est</span>, ylim <span class="op">=</span> <span class="va">ylim</span>, main <span class="op">=</span> <span class="st">"(C) Trimmed LDW-CPS1"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">band</span> <span class="op">&lt;-</span> <span class="va">out3</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="va">est</span> <span class="op">&lt;-</span> <span class="va">out3</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu">plot_coef</span><span class="op">(</span><span class="va">out7</span>, band <span class="op">=</span> <span class="va">band</span>, line <span class="op">=</span> <span class="va">est</span>, ylim <span class="op">=</span> <span class="va">ylim</span>, main <span class="op">=</span> <span class="st">"(D) Trimmed LDW-PSID1"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02-LDW_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">FIGURE 6. Placebo Test: ’75 Earnings as the Outcome</figcaption></figure>
</div>
</div>
</div>
<p>Figure 6 presents the findings. Not surprisingly, the experimental benchmarks are near zero and statistically insignificant. However, all estimators using nonexperimental data generate large, negative estimates. Again, with trimmed data, the estimates are stable but remain statistically different from zero.</p>
<p>The <em>Placebo</em> ATT results are presented in the table below:</p>
<div class="cell" data-hash="02-LDW_cache/html/unnamed-chunk-18_93246ec27b6a7a992cfa2cb36b529a6a">
<details><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># print the result</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">out4</span>, <span class="va">out5</span>, <span class="va">out6</span>, <span class="va">out7</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">out1</span><span class="op">)</span></span>
<span><span class="va">sav</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="st">""</span>, <span class="va">n</span><span class="op">+</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">*</span><span class="fl">3</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">out</span> <span class="op">&lt;-</span> <span class="va">a</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">sav</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span><span class="op">*</span><span class="fl">3</span><span class="op">-</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">out</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="va">sav</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span><span class="op">*</span><span class="fl">3</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">out</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="st">")"</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="va">sav</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">out1</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">sav</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">out1</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="st">")"</span><span class="op">)</span></span>
<span><span class="va">sav</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">out1</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">sav</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">out1</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="st">")"</span><span class="op">)</span></span>
<span><span class="va">sav</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">7</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">out2</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">sav</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">8</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">out2</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="st">")"</span><span class="op">)</span></span>
<span><span class="va">sav</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">out3</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">sav</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">11</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"("</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.2f"</span>, <span class="va">out3</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="st">")"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">sav</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"LDW-CPS1"</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">"LDW-PSID1"</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">"LDW-CPS1 (PS Trimmed) "</span>, <span class="st">""</span>, <span class="st">""</span>, <span class="st">"LDW-PSID1 (PS Trimmed)"</span>, <span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">sav</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Experimental Benchmark"</span>, <span class="st">"Difference-in-Means"</span>, <span class="st">"Regression"</span>, <span class="st">" Oaxaca Blinder"</span>, <span class="st">"GRF"</span>, <span class="st">"NN Matching"</span>, <span class="st">"PS Matching"</span>, <span class="st">"IPW"</span>, <span class="st">"CBPS"</span>, <span class="st">"Entropy Balancing"</span>, <span class="st">"DML-ElasticNet"</span>, <span class="st">"AIPW-GRF"</span><span class="op">)</span></span>
<span><span class="va">sav</span> <span class="op">%&gt;%</span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>booktabs<span class="op">=</span><span class="cn">TRUE</span>, caption <span class="op">=</span> <span class="st">" Table B2 in the Supplementary Materials (SM)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Table B2 in the Supplementary Materials (SM)</caption>
<colgroup>
<col style="width: 17%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 2%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 2%">
<col style="width: 17%">
<col style="width: 6%">
<col style="width: 2%">
<col style="width: 17%">
<col style="width: 7%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">LDW-CPS1</th>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
<th style="text-align: left;">LDW-PSID1</th>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
<th style="text-align: left;">LDW-CPS1 (PS Trimmed)</th>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
<th style="text-align: left;">LDW-PSID1 (PS Trimmed)</th>
<th style="text-align: left;"></th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Experimental Benchmark</td>
<td style="text-align: left;">265.15</td>
<td style="text-align: left;">(305.00)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">265.15</td>
<td style="text-align: left;">(305.00)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">273.86</td>
<td style="text-align: left;">(334.27)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-210.15</td>
<td style="text-align: left;">(693.12)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Difference-in-Means</td>
<td style="text-align: left;">-12118.75</td>
<td style="text-align: left;">(247.18)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-17531.28</td>
<td style="text-align: left;">(360.60)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-1456.55</td>
<td style="text-align: left;">(484.60)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-4670.77</td>
<td style="text-align: left;">(1057.12)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Regression</td>
<td style="text-align: left;">-1134.82</td>
<td style="text-align: left;">(272.44)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-2757.40</td>
<td style="text-align: left;">(589.02)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-1256.96</td>
<td style="text-align: left;">(329.96)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-3694.56</td>
<td style="text-align: left;">(852.84)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Oaxaca Blinder</td>
<td style="text-align: left;">-1096.70</td>
<td style="text-align: left;">(395.18)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-2640.76</td>
<td style="text-align: left;">(367.46)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-1232.17</td>
<td style="text-align: left;">(402.36)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-3528.62</td>
<td style="text-align: left;">(827.83)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GRF</td>
<td style="text-align: left;">-1579.02</td>
<td style="text-align: left;">(373.45)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-4334.56</td>
<td style="text-align: left;">(343.83)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-1345.15</td>
<td style="text-align: left;">(362.39)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-3879.50</td>
<td style="text-align: left;">(656.89)</td>
</tr>
<tr class="even">
<td style="text-align: left;">NN Matching</td>
<td style="text-align: left;">-1465.93</td>
<td style="text-align: left;">(351.78)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-1913.65</td>
<td style="text-align: left;">(805.37)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-1411.42</td>
<td style="text-align: left;">(357.45)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-3790.08</td>
<td style="text-align: left;">(929.82)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PS Matching</td>
<td style="text-align: left;">-1454.83</td>
<td style="text-align: left;">(421.13)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-2838.18</td>
<td style="text-align: left;">(499.11)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-1424.20</td>
<td style="text-align: left;">(464.65)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-5785.12</td>
<td style="text-align: left;">(965.43)</td>
</tr>
<tr class="even">
<td style="text-align: left;">IPW</td>
<td style="text-align: left;">-1568.77</td>
<td style="text-align: left;">(337.54)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-3183.02</td>
<td style="text-align: left;">(734.24)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-1674.99</td>
<td style="text-align: left;">(500.00)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-4199.29</td>
<td style="text-align: left;">(1022.62)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CBPS</td>
<td style="text-align: left;">-1227.83</td>
<td style="text-align: left;">(297.89)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-2282.31</td>
<td style="text-align: left;">(834.92)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-1231.13</td>
<td style="text-align: left;">(468.41)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-3676.24</td>
<td style="text-align: left;">(1059.83)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Entropy Balancing</td>
<td style="text-align: left;">-1228.49</td>
<td style="text-align: left;">(297.88)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-2250.80</td>
<td style="text-align: left;">(842.15)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-1231.01</td>
<td style="text-align: left;">(468.56)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-3551.89</td>
<td style="text-align: left;">(1062.82)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DML-ElasticNet</td>
<td style="text-align: left;">-1152.96</td>
<td style="text-align: left;">(271.75)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-2725.28</td>
<td style="text-align: left;">(591.57)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-1262.44</td>
<td style="text-align: left;">(330.59)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-3779.88</td>
<td style="text-align: left;">(830.53)</td>
</tr>
<tr class="even">
<td style="text-align: left;">AIPW-GRF</td>
<td style="text-align: left;">-1275.34</td>
<td style="text-align: left;">(262.33)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-2506.00</td>
<td style="text-align: left;">(620.09)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-1370.92</td>
<td style="text-align: left;">(370.87)</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">-3836.34</td>
<td style="text-align: left;">(823.57)</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The first row of the table shows that the experimental benchmarks are near zero and statistically insignificant. In the placebo analysis, all estimators using observational data generate large, negative estimates.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Moreover, almost all the estimators are significantly different from the targeted analysis. Since the placebo estimates are always large and negative while the estimates in the former analysis are smaller in magnitude or positive, this could suggest that the methods are sensitive to the true effect.</p>
</div>
</div>
</section><section id="sensitivity-analyses" class="level2" data-number="2.8"><h2 data-number="2.8" class="anchored" data-anchor-id="sensitivity-analyses">
<span class="header-section-number">2.8</span> Sensitivity Analyses</h2>
<p>We also conduct sensitivity analyses using the LDW data, with results depicted in contour plots below. We can use <code>sens_ana</code> to conduct the sensitivity analyses.</p>
<div class="cell" data-fig.asp="0.75" data-hash="02-LDW_cache/html/unnamed-chunk-19_9e4cfe76e580216420b11ef02d2b507d">
<details open=""><summary>Code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="st">"re78"</span></span>
<span><span class="va">treat</span> <span class="op">&lt;-</span> <span class="st">"treat"</span></span>
<span><span class="va">covar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"age"</span>, <span class="st">"education"</span>, <span class="st">"black"</span>, <span class="st">"hispanic"</span>, <span class="st">"married"</span>, <span class="st">"nodegree"</span>, <span class="st">"re74"</span>, <span class="st">"re75"</span>, <span class="st">"u74"</span>, <span class="st">"u75"</span><span class="op">)</span></span>
<span><span class="va">bm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"re75"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ldw data</span></span>
<span><span class="co"># sens_ana(ldw, Y, treat, covar, bm)</span></span>
<span></span>
<span><span class="co"># trimmed LDW-CPS data</span></span>
<span><span class="fu">sens_ana</span><span class="op">(</span><span class="va">ldw_cps</span>, <span class="va">Y</span>, <span class="va">treat</span>, <span class="va">covar</span>, <span class="va">bm</span>, kd <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># trimmed LDW-PSID data</span></span>
<span><span class="fu">sens_ana</span><span class="op">(</span><span class="va">ldw_psid</span>, <span class="va">Y</span>, <span class="va">treat</span>, <span class="va">covar</span>, <span class="va">bm</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="02-LDW_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
<figcaption class="figure-caption">FIGURE B3. Sensitivity Analyses for Trimmed LDW-CPS1 and LDW-PSID1</figcaption></figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>The analyses suggest that the estimated training effect based on trimmed LDW-CPS is less sensitive to potential confounders compared to trimmed LDW-PSID.</p>
</div>
</div>
<p>For instance, with trimmed LDW-CPS, the estimate remains positive and large even when a confounder’s correlations with treatment and outcome are triple those of re75, whereas the presence of re75 would lead to a negative estimated effect using trimmed LDW-PSID.</p>
</section><section id="summary" class="level2" data-number="2.9"><h2 data-number="2.9" class="anchored" data-anchor-id="summary">
<span class="header-section-number">2.9</span> Summary</h2>
<p>After reexamining both the LDW data and the original Lalonde male sample, we offer some new insights into the challenge posed by LaLonde. First, we agree with existing literature that ensuring overlap and using comparable control units are essential for credible causal estimates. Second, while the choice of method is less critical with overlap, as most methods yield similar results, the propensity score remains a vital tool for assessing overlap and is integral to many estimators. Third, we stress the importance of understanding the treatment assignment mechanism and the need for additional tests to validate unconfoundedness. The LDW dataset is somewhat unique in that many methods approximate the experimental benchmark for the <em>average effects</em> under overlap, a success not mirrored with the original LaLonde data. However, even with LDW data, placebo tests fail to substantiate unconfoundedness, and sensitivity analysis reveals the fragility of the regression estimate using LDW-PSID1.</p>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-calonico2017women" class="csl-entry" role="listitem">
Calónico, Sebastian, and Jeffrey Smith. 2017. <span>“The Women of the National Supported Work Demonstration.”</span> <em>Journal of Labor Economics</em> 35 (S1): S65–97.
</div>
<div id="ref-dehejiawahba" class="csl-entry" role="listitem">
Dehejia, Rajeev H, and Sadek Wahba. 1999. <span>“Causal Effects in Nonexperimental Studies: Reevaluating the Evaluation of Training Programs.”</span> <em>Journal of the American Statistical Association</em> 94 (448): 1053–62.
</div>
<div id="ref-dehejia2002propensity" class="csl-entry" role="listitem">
———. 2002. <span>“Propensity Score-Matching Methods for Nonexperimental Causal Studies.”</span> <em>Review of Economics and Statistics</em> 84 (1): 151–61.
</div>
<div id="ref-firpo2007efficient" class="csl-entry" role="listitem">
Firpo, Sergio. 2007. <span>“Efficient Semiparametric Estimation of Quantile Treatment Effects.”</span> <em>Econometrica</em> 75 (1): 259–76.
</div>
<div id="ref-imbensrubinsacerdote" class="csl-entry" role="listitem">
Imbens, Guido W, Donald B Rubin, and Bruce I Sacerdote. 2001. <span>“Estimating the Effect of Unearned Income on Labor Earnings, Savings, and Consumption: Evidence from a Survey of Lottery Players.”</span> <em>American Economic Review</em>, 778–94.
</div>
<div id="ref-LaLonde" class="csl-entry" role="listitem">
LaLonde, Robert J. 1986. <span>“Evaluating the Econometric Evaluations of Training Programs with Experimental Data.”</span> <em>The American Economic Review</em>, 604–20.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./01-Start.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting Started</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./03-NSW.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">LaLonde Male Samples</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>